<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.17
Devel::Cover is copyright 2001-2012, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: /usr/local/lib/perl5/5.20.1/Module/Metadata.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">/usr/local/lib/perl5/5.20.1/Module/Metadata.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">38.1%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># -*- mode: cperl; tab-width: 8; indent-tabs-mode: nil; basic-offset: 2 -*-</td></tr>
<tr><td class="h">2</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># vim:ts=8:sw=2:et:sta:sts=2</td></tr>
<tr><td class="h">3</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package Module::Metadata;</td></tr>
<tr><td class="h">4</td><td colspan="7"></td></tr><tr><td class="h">5</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Adapted from Perl-licensed code originally distributed with</td></tr>
<tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Module-Build by Ken Williams</td></tr>
<tr><td class="h">7</td><td colspan="7"></td></tr><tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This module provides routines to gather information about</td></tr>
<tr><td class="h">9</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># perl modules (assuming this may be expanded in the distant</td></tr>
<tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># parrot future to look at other types of modules).</td></tr>
<tr><td class="h">11</td><td colspan="7"></td></tr><tr><td class="h">12</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L12">70</a></div></td><td></td><td><div>246</div><div>78</div><div>1683</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">13</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L13">70</a></div></td><td></td><td><div>263</div><div>70</div><div>2794</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">14</td><td colspan="7"></td></tr><tr><td class="h">15</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;1.000019&#39;;</td></tr>
<tr><td class="h">16</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$VERSION = eval $VERSION;</td></tr>
<tr><td class="h">17</td><td colspan="7"></td></tr><tr><td class="h">18</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L18">70</a></div></td><td></td><td><div>262</div><div>70</div><div>2363</div></td><td class="s">use Carp qw/croak/;</td></tr>
<tr><td class="h">19</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L19">70</a></div></td><td></td><td><div>262</div><div>77</div><div>2241</div></td><td class="s">use File::Spec;</td></tr>
<tr><td class="h">20</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L20">70</a></div></td><td></td><td><div>249</div><div>66</div><div>8144</div></td><td class="s">use IO::File;</td></tr>
<tr><td class="h">21</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L21">70</a></div></td><td></td><td><div>264</div><div>1050</div><div>385</div></td><td class="s">use version 0.87;</td></tr>
<tr><td class="h">22</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">BEGIN {</td></tr>
<tr><td class="h">23</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L23">50</a></div></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L23">70</a></div></td><td></td><td><div>210</div></td><td class="s">&nbsp;&nbsp;if ($INC{&#39;Log/Contextual.pm&#39;}) {</td></tr>
<tr><td class="h">24</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Log::Contextual-&gt;import(&#39;log_info&#39;);</td></tr>
<tr><td class="h">25</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">26</td><td><div class="c3">70</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L26">0</a></div></td><td></td><td><div>1314</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;*log_info = sub (&amp;) { warn $_[0]-&gt;() };</td></tr>
<tr><td class="h">27</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">28</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">29</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L29">70</a></div></td><td></td><td><div>283</div><div>1202</div><div>235213</div></td><td class="s">use File::Find qw(find);</td></tr>
<tr><td class="h">30</td><td colspan="7"></td></tr><tr><td class="h">31</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $V_NUM_REGEXP = qr{v?[0-9._]+};&nbsp;&nbsp;# crudely, a v-string or decimal</td></tr>
<tr><td class="h">32</td><td colspan="7"></td></tr><tr><td class="h">33</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $PKG_FIRST_WORD_REGEXP = qr{ # the FIRST word in a package name</td></tr>
<tr><td class="h">34</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;[a-zA-Z_]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the first word CANNOT start with a digit</td></tr>
<tr><td class="h">35</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(?:</td></tr>
<tr><td class="h">36</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\w&#39;]?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# can contain letters, digits, _, or ticks</td></tr>
<tr><td class="h">37</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# But, NO multi-ticks or trailing ticks</td></tr>
<tr><td class="h">38</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;)*</td></tr>
<tr><td class="h">39</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}x;</td></tr>
<tr><td class="h">40</td><td colspan="7"></td></tr><tr><td class="h">41</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $PKG_ADDL_WORD_REGEXP = qr{ # the 2nd+ word in a package name</td></tr>
<tr><td class="h">42</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;\w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the 2nd+ word CAN start with digits</td></tr>
<tr><td class="h">43</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(?:</td></tr>
<tr><td class="h">44</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\w&#39;]?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# and can contain letters or ticks</td></tr>
<tr><td class="h">45</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# But, NO multi-ticks or trailing ticks</td></tr>
<tr><td class="h">46</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;)*</td></tr>
<tr><td class="h">47</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}x;</td></tr>
<tr><td class="h">48</td><td colspan="7"></td></tr><tr><td class="h">49</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $PKG_NAME_REGEXP = qr{ # match a package name</td></tr>
<tr><td class="h">50</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;(?: :: )?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# a pkg name can start with aristotle</td></tr>
<tr><td class="h">51</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;$PKG_FIRST_WORD_REGEXP&nbsp;&nbsp;# a package word</td></tr>
<tr><td class="h">52</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;(?:</td></tr>
<tr><td class="h">53</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(?: :: )+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;### aristotle (allow one or many times)</td></tr>
<tr><td class="h">54</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$PKG_ADDL_WORD_REGEXP ### a package word</td></tr>
<tr><td class="h">55</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;)*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ^ zero, one or many times</td></tr>
<tr><td class="h">56</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;(?:</td></tr>
<tr><td class="h">57</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# allow trailing aristotle</td></tr>
<tr><td class="h">58</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;)?</td></tr>
<tr><td class="h">59</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}x;</td></tr>
<tr><td class="h">60</td><td colspan="7"></td></tr><tr><td class="h">61</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $PKG_REGEXP&nbsp;&nbsp;= qr{&nbsp;&nbsp;&nbsp;# match a package declaration</td></tr>
<tr><td class="h">62</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;^[\s\{;]*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# intro chars on a line</td></tr>
<tr><td class="h">63</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;package&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the word &#39;package&#39;</td></tr>
<tr><td class="h">64</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;\s+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# whitespace</td></tr>
<tr><td class="h">65</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;($PKG_NAME_REGEXP)&nbsp;&nbsp;&nbsp;&nbsp;# a package name</td></tr>
<tr><td class="h">66</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;\s*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# optional whitespace</td></tr>
<tr><td class="h">67</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;($V_NUM_REGEXP)?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# optional version number</td></tr>
<tr><td class="h">68</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;\s*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# optional whitesapce</td></tr>
<tr><td class="h">69</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;[;\{]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# semicolon line terminator or block start (since 5.16)</td></tr>
<tr><td class="h">70</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}x;</td></tr>
<tr><td class="h">71</td><td colspan="7"></td></tr><tr><td class="h">72</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $VARNAME_REGEXP = qr{ # match fully-qualified VERSION name</td></tr>
<tr><td class="h">73</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;([\$*])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# sigil - $ or *</td></tr>
<tr><td class="h">74</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;(</td></tr>
<tr><td class="h">75</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# optional leading package name</td></tr>
<tr><td class="h">76</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(?:::|\&#39;)?&nbsp;&nbsp;# possibly starting like just :: (Ì&nbsp;&nbsp;la $::VERSION)</td></tr>
<tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(?:\w+(?:::|\&#39;))*&nbsp;&nbsp;# Foo::Bar:: ...</td></tr>
<tr><td class="h">78</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;)?</td></tr>
<tr><td class="h">79</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;VERSION</td></tr>
<tr><td class="h">80</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;)\b</td></tr>
<tr><td class="h">81</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}x;</td></tr>
<tr><td class="h">82</td><td colspan="7"></td></tr><tr><td class="h">83</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $VERS_REGEXP = qr{ # match a VERSION definition</td></tr>
<tr><td class="h">84</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;(?:</td></tr>
<tr><td class="h">85</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;\(\s*$VARNAME_REGEXP\s*\) # with parens</td></tr>
<tr><td class="h">86</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;|</td></tr>
<tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$VARNAME_REGEXP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# without parens</td></tr>
<tr><td class="h">88</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;)</td></tr>
<tr><td class="h">89</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;\s*</td></tr>
<tr><td class="h">90</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;=[^=~]&nbsp;&nbsp;# = but not ==, nor =~</td></tr>
<tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}x;</td></tr>
<tr><td class="h">92</td><td colspan="7"></td></tr><tr><td class="h">93</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new_from_file {</td></tr>
<tr><td class="h">94</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L94">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $class&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">95</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $filename = File::Spec-&gt;rel2abs( shift );</td></tr>
<tr><td class="h">96</td><td colspan="7"></td></tr><tr><td class="h">97</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L97">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L97">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return undef unless defined( $filename ) &amp;&amp; -f $filename;</td></tr>
<tr><td class="h">98</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return $class-&gt;_init(undef, $filename, @_);</td></tr>
<tr><td class="h">99</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">100</td><td colspan="7"></td></tr><tr><td class="h">101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new_from_handle {</td></tr>
<tr><td class="h">102</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L102">70</a></div></td><td><div class="c3">1</div></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;my $class&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">103</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;my $handle&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">104</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;my $filename = shift;</td></tr>
<tr><td class="h">105</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L105">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L105">33</a></div></td><td></td><td></td><td><div>329</div></td><td class="s">&nbsp;&nbsp;return undef unless defined($handle) &amp;&amp; defined($filename);</td></tr>
<tr><td class="h">106</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>1187</div></td><td class="s">&nbsp;&nbsp;$filename = File::Spec-&gt;rel2abs( $filename );</td></tr>
<tr><td class="h">107</td><td colspan="7"></td></tr><tr><td class="h">108</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>255</div></td><td class="s">&nbsp;&nbsp;return $class-&gt;_init(undef, $filename, @_, handle =&gt; $handle);</td></tr>
<tr><td class="h">109</td><td colspan="7"></td></tr><tr><td class="h">110</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">111</td><td colspan="7"></td></tr><tr><td class="h">112</td><td colspan="7"></td></tr><tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new_from_module {</td></tr>
<tr><td class="h">114</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L114">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $class&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">115</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $module&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">116</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my %props&nbsp;&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">117</td><td colspan="7"></td></tr><tr><td class="h">118</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L118">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;$props{inc} ||= \@INC;</td></tr>
<tr><td class="h">119</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $filename = $class-&gt;find_module_by_name( $module, $props{inc} );</td></tr>
<tr><td class="h">120</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L120">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L120">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return undef unless defined( $filename ) &amp;&amp; -f $filename;</td></tr>
<tr><td class="h">121</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return $class-&gt;_init($module, $filename, %props);</td></tr>
<tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">123</td><td colspan="7"></td></tr><tr><td class="h">124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">125</td><td colspan="7"></td></tr><tr><td class="h">126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;my $compare_versions = sub {</td></tr>
<tr><td class="h">127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($v1, $op, $v2) = @_;</td></tr>
<tr><td class="h">128</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$v1 = version-&gt;new($v1)</td></tr>
<tr><td class="h">129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless UNIVERSAL::isa($v1,&#39;version&#39;);</td></tr>
<tr><td class="h">130</td><td colspan="7"></td></tr><tr><td class="h">131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $eval_str = &quot;\$v1 $op \$v2&quot;;</td></tr>
<tr><td class="h">132</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result&nbsp;&nbsp;&nbsp;= eval $eval_str;</td></tr>
<tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;log_info { &quot;error comparing versions: &#39;$eval_str&#39; $@&quot; } if $@;</td></tr>
<tr><td class="h">134</td><td colspan="7"></td></tr><tr><td class="h">135</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">136</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;};</td></tr>
<tr><td class="h">137</td><td colspan="7"></td></tr><tr><td class="h">138</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;my $normalize_version = sub {</td></tr>
<tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($version) = @_;</td></tr>
<tr><td class="h">140</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $version =~ /[=&lt;&gt;!,]/ ) { # logic, not just version</td></tr>
<tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# take as is without modification</td></tr>
<tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">143</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ( ref $version eq &#39;version&#39; ) { # version objects</td></tr>
<tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$version = $version-&gt;is_qv ? $version-&gt;normal : $version-&gt;stringify;</td></tr>
<tr><td class="h">145</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">146</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $version =~ /^[^v][^.]*\.[^.]+\./ ) { # no leading v, multiple dots</td></tr>
<tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# normalize string tuples without &quot;v&quot;: &quot;1.2.3&quot; -&gt; &quot;v1.2.3&quot;</td></tr>
<tr><td class="h">148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$version = &quot;v$version&quot;;</td></tr>
<tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# leave alone</td></tr>
<tr><td class="h">152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $version;</td></tr>
<tr><td class="h">154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;};</td></tr>
<tr><td class="h">155</td><td colspan="7"></td></tr><tr><td class="h">156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# separate out some of the conflict resolution logic</td></tr>
<tr><td class="h">157</td><td colspan="7"></td></tr><tr><td class="h">158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;my $resolve_module_versions = sub {</td></tr>
<tr><td class="h">159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $packages = shift;</td></tr>
<tr><td class="h">160</td><td colspan="7"></td></tr><tr><td class="h">161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $file, $version );</td></tr>
<tr><td class="h">162</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $err = &#39;&#39;;</td></tr>
<tr><td class="h">163</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $p ( @$packages ) {</td></tr>
<tr><td class="h">164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( $p-&gt;{version} ) ) {</td></tr>
<tr><td class="h">165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( $version ) ) {</td></tr>
<tr><td class="h">166</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $compare_versions-&gt;( $version, &#39;!=&#39;, $p-&gt;{version} ) ) {</td></tr>
<tr><td class="h">167</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$err .= &quot;&nbsp;&nbsp;$p-&gt;{file} ($p-&gt;{version})\n&quot;;</td></tr>
<tr><td class="h">168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# same version declared multiple times, ignore</td></tr>
<tr><td class="h">170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">172</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file&nbsp;&nbsp;&nbsp;&nbsp;= $p-&gt;{file};</td></tr>
<tr><td class="h">173</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$version = $p-&gt;{version};</td></tr>
<tr><td class="h">174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file ||= $p-&gt;{file} if defined( $p-&gt;{file} );</td></tr>
<tr><td class="h">177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">178</td><td colspan="7"></td></tr><tr><td class="h">179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $err ) {</td></tr>
<tr><td class="h">180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$err = &quot;&nbsp;&nbsp;$file ($version)\n&quot; . $err;</td></tr>
<tr><td class="h">181</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">182</td><td colspan="7"></td></tr><tr><td class="h">183</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %result = (</td></tr>
<tr><td class="h">184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $file,</td></tr>
<tr><td class="h">185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version =&gt; $version,</td></tr>
<tr><td class="h">186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $err</td></tr>
<tr><td class="h">187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">188</td><td colspan="7"></td></tr><tr><td class="h">189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \%result;</td></tr>
<tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;};</td></tr>
<tr><td class="h">191</td><td colspan="7"></td></tr><tr><td class="h">192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;sub provides {</td></tr>
<tr><td class="h">193</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L193">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">194</td><td colspan="7"></td></tr><tr><td class="h">195</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L195">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;provides() requires key/value pairs \n&quot; if @_ % 2;</td></tr>
<tr><td class="h">196</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %args = @_;</td></tr>
<tr><td class="h">197</td><td colspan="7"></td></tr><tr><td class="h">198</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L198">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L198">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;provides() takes only one of &#39;dir&#39; or &#39;files&#39;\n&quot;</td></tr>
<tr><td class="h">199</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $args{dir} &amp;&amp; $args{files};</td></tr>
<tr><td class="h">200</td><td colspan="7"></td></tr><tr><td class="h">201</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L201">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;provides() requires a &#39;version&#39; argument&quot;</td></tr>
<tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless defined $args{version};</td></tr>
<tr><td class="h">203</td><td colspan="7"></td></tr><tr><td class="h">204</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;provides() does not support version &#39;$args{version}&#39; metadata&quot;</td></tr>
<tr><td class="h">205</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L205">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless grep { $args{version} eq $_ } qw/1.4 2/;</td></tr>
<tr><td class="h">206</td><td colspan="7"></td></tr><tr><td class="h">207</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L207">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{prefix} = &#39;lib&#39; unless defined $args{prefix};</td></tr>
<tr><td class="h">208</td><td colspan="7"></td></tr><tr><td class="h">209</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $p;</td></tr>
<tr><td class="h">210</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L210">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $args{dir} ) {</td></tr>
<tr><td class="h">211</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$p = $class-&gt;package_versions_from_directory($args{dir});</td></tr>
<tr><td class="h">212</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">213</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">214</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L214">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;provides() requires &#39;files&#39; to be an array reference\n&quot;</td></tr>
<tr><td class="h">215</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ref $args{files} eq &#39;ARRAY&#39;;</td></tr>
<tr><td class="h">216</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$p = $class-&gt;package_versions_from_directory($args{files});</td></tr>
<tr><td class="h">217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">218</td><td colspan="7"></td></tr><tr><td class="h">219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Now, fix up files with prefix</td></tr>
<tr><td class="h">220</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L220">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( length $args{prefix} ) { # check in case disabled with q{}</td></tr>
<tr><td class="h">221</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args{prefix} =~ s{/$}{};</td></tr>
<tr><td class="h">222</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $v ( values %$p ) {</td></tr>
<tr><td class="h">223</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$v-&gt;{file} = &quot;$args{prefix}/$v-&gt;{file}&quot;;</td></tr>
<tr><td class="h">224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">225</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">226</td><td colspan="7"></td></tr><tr><td class="h">227</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $p</td></tr>
<tr><td class="h">228</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">229</td><td colspan="7"></td></tr><tr><td class="h">230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;sub package_versions_from_directory {</td></tr>
<tr><td class="h">231</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L231">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $class, $dir, $files ) = @_;</td></tr>
<tr><td class="h">232</td><td colspan="7"></td></tr><tr><td class="h">233</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @files;</td></tr>
<tr><td class="h">234</td><td colspan="7"></td></tr><tr><td class="h">235</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L235">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $files ) {</td></tr>
<tr><td class="h">236</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@files = @$files;</td></tr>
<tr><td class="h">237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find( {</td></tr>
<tr><td class="h">239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wanted =&gt; sub {</td></tr>
<tr><td class="h">240</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L240">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L240">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L240">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @files, $_ if -f $_ &amp;&amp; /\.pm$/;</td></tr>
<tr><td class="h">241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">242</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_chdir =&gt; 1,</td></tr>
<tr><td class="h">243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, $dir );</td></tr>
<tr><td class="h">244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">245</td><td colspan="7"></td></tr><tr><td class="h">246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# First, we enumerate all packages &amp; versions,</td></tr>
<tr><td class="h">247</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# separating into primary &amp; alternative candidates</td></tr>
<tr><td class="h">248</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( %prime, %alt );</td></tr>
<tr><td class="h">249</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $file (@files) {</td></tr>
<tr><td class="h">250</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $mapped_filename = File::Spec::Unix-&gt;abs2rel( $file, $dir );</td></tr>
<tr><td class="h">251</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @path = split( /\//, $mapped_filename );</td></tr>
<tr><td class="h">252</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $prime_package = join( &#39;::&#39;, @path )) =~ s/\.pm$//;</td></tr>
<tr><td class="h">253</td><td colspan="7"></td></tr><tr><td class="h">254</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $pm_info = $class-&gt;new_from_file( $file );</td></tr>
<tr><td class="h">255</td><td colspan="7"></td></tr><tr><td class="h">256</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $package ( $pm_info-&gt;packages_inside ) {</td></tr>
<tr><td class="h">257</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L257">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $package eq &#39;main&#39;;&nbsp;&nbsp;# main can appear numerous times, ignore</td></tr>
<tr><td class="h">258</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L258">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $package eq &#39;DB&#39;;&nbsp;&nbsp;&nbsp;&nbsp;# special debugging package, ignore</td></tr>
<tr><td class="h">259</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L259">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if grep /^_/, split( /::/, $package ); # private package, ignore</td></tr>
<tr><td class="h">260</td><td colspan="7"></td></tr><tr><td class="h">261</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $version = $pm_info-&gt;version( $package );</td></tr>
<tr><td class="h">262</td><td colspan="7"></td></tr><tr><td class="h">263</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L263">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime_package = $package if lc($prime_package) eq lc($package);</td></tr>
<tr><td class="h">264</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L264">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $package eq $prime_package ) {</td></tr>
<tr><td class="h">265</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L265">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( exists( $prime{$package} ) ) {</td></tr>
<tr><td class="h">266</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;Unexpected conflict in &#39;$package&#39;; multiple versions found.\n&quot;;</td></tr>
<tr><td class="h">267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">268</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L268">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mapped_filename = &quot;$package.pm&quot; if lc(&quot;$package.pm&quot;) eq lc($mapped_filename);</td></tr>
<tr><td class="h">269</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{file} = $mapped_filename;</td></tr>
<tr><td class="h">270</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L270">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{version} = $version if defined( $version );</td></tr>
<tr><td class="h">271</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">272</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">273</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @{$alt{$package}}, {</td></tr>
<tr><td class="h">274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $mapped_filename,</td></tr>
<tr><td class="h">275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version =&gt; $version,</td></tr>
<tr><td class="h">276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} );</td></tr>
<tr><td class="h">277</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">278</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">280</td><td colspan="7"></td></tr><tr><td class="h">281</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Then we iterate over all the packages found above, identifying conflicts</td></tr>
<tr><td class="h">282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# and selecting the &quot;best&quot; candidate for recording the file &amp; version</td></tr>
<tr><td class="h">283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# for each package.</td></tr>
<tr><td class="h">284</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $package ( keys( %alt ) ) {</td></tr>
<tr><td class="h">285</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $result = $resolve_module_versions-&gt;( $alt{$package} );</td></tr>
<tr><td class="h">286</td><td colspan="7"></td></tr><tr><td class="h">287</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L287">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( exists( $prime{$package} ) ) { # primary package selected</td></tr>
<tr><td class="h">288</td><td colspan="7"></td></tr><tr><td class="h">289</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L289">0</a></div><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L289">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $result-&gt;{err} ) {</td></tr>
<tr><td class="h">290</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use the selected primary package, but there are conflicting</td></tr>
<tr><td class="h">291</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# errors among multiple alternative packages that need to be</td></tr>
<tr><td class="h">292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# reported</td></tr>
<tr><td class="h">293</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_info {</td></tr>
<tr><td class="h">294</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L294">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Found conflicting versions for package &#39;$package&#39;\n&quot; .</td></tr>
<tr><td class="h">295</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;$prime{$package}{file} ($prime{$package}{version})\n&quot; .</td></tr>
<tr><td class="h">296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{err}</td></tr>
<tr><td class="h">297</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">298</td><td colspan="7"></td></tr><tr><td class="h">299</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( defined( $result-&gt;{version} ) ) {</td></tr>
<tr><td class="h">300</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# There is a primary package selected, and exactly one</td></tr>
<tr><td class="h">301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# alternative package</td></tr>
<tr><td class="h">302</td><td colspan="7"></td></tr><tr><td class="h">303</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L303">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L303">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( exists( $prime{$package}{version} ) &amp;&amp;</td></tr>
<tr><td class="h">304</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined( $prime{$package}{version} ) ) {</td></tr>
<tr><td class="h">305</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Unless the version of the primary package agrees with the</td></tr>
<tr><td class="h">306</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# version of the alternative package, report a conflict</td></tr>
<tr><td class="h">307</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L307">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $compare_versions-&gt;(</td></tr>
<tr><td class="h">308</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{version}, &#39;!=&#39;, $result-&gt;{version}</td></tr>
<tr><td class="h">309</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</td></tr>
<tr><td class="h">310</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) {</td></tr>
<tr><td class="h">311</td><td colspan="7"></td></tr><tr><td class="h">312</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_info {</td></tr>
<tr><td class="h">313</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L313">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Found conflicting versions for package &#39;$package&#39;\n&quot; .</td></tr>
<tr><td class="h">314</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;$prime{$package}{file} ($prime{$package}{version})\n&quot; .</td></tr>
<tr><td class="h">315</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;$result-&gt;{file} ($result-&gt;{version})\n&quot;</td></tr>
<tr><td class="h">316</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">318</td><td colspan="7"></td></tr><tr><td class="h">319</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The prime package selected has no version so, we choose to</td></tr>
<tr><td class="h">321</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# use any alternative package that does have a version</td></tr>
<tr><td class="h">322</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{file}&nbsp;&nbsp;&nbsp;&nbsp;= $result-&gt;{file};</td></tr>
<tr><td class="h">323</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{version} = $result-&gt;{version};</td></tr>
<tr><td class="h">324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">325</td><td colspan="7"></td></tr><tr><td class="h">326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">327</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# no alt package found with a version, but we have a prime</td></tr>
<tr><td class="h">328</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# package so we use it whether it has a version or not</td></tr>
<tr><td class="h">329</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">330</td><td colspan="7"></td></tr><tr><td class="h">331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else { # No primary package was selected, use the best alternative</td></tr>
<tr><td class="h">332</td><td colspan="7"></td></tr><tr><td class="h">333</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L333">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $result-&gt;{err} ) {</td></tr>
<tr><td class="h">334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_info {</td></tr>
<tr><td class="h">335</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L335">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Found conflicting versions for package &#39;$package&#39;\n&quot; .</td></tr>
<tr><td class="h">336</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result-&gt;{err}</td></tr>
<tr><td class="h">337</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">339</td><td colspan="7"></td></tr><tr><td class="h">340</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Despite possible conflicting versions, we choose to record</td></tr>
<tr><td class="h">341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# something rather than nothing</td></tr>
<tr><td class="h">342</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{file}&nbsp;&nbsp;&nbsp;&nbsp;= $result-&gt;{file};</td></tr>
<tr><td class="h">343</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L343">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$prime{$package}{version} = $result-&gt;{version}</td></tr>
<tr><td class="h">344</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if defined( $result-&gt;{version} );</td></tr>
<tr><td class="h">345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">347</td><td colspan="7"></td></tr><tr><td class="h">348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Normalize versions.&nbsp;&nbsp;Can&#39;t use exists() here because of bug in YAML::Node.</td></tr>
<tr><td class="h">349</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# XXX &quot;bug in YAML::Node&quot; comment seems irrelevant -- dagolden, 2009-05-18</td></tr>
<tr><td class="h">350</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for (grep defined $_-&gt;{version}, values %prime) {</td></tr>
<tr><td class="h">351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_-&gt;{version} = $normalize_version-&gt;( $_-&gt;{version} );</td></tr>
<tr><td class="h">352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">353</td><td colspan="7"></td></tr><tr><td class="h">354</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \%prime;</td></tr>
<tr><td class="h">355</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">357</td><td colspan="7"></td></tr><tr><td class="h">358</td><td colspan="7"></td></tr><tr><td class="h">359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _init {</td></tr>
<tr><td class="h">360</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L360">70</a></div></td><td></td><td><div>104</div></td><td class="s">&nbsp;&nbsp;my $class&nbsp;&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">361</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;my $module&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">362</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;my $filename = shift;</td></tr>
<tr><td class="h">363</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>150</div></td><td class="s">&nbsp;&nbsp;my %props = @_;</td></tr>
<tr><td class="h">364</td><td colspan="7"></td></tr><tr><td class="h">365</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;my $handle = delete $props{handle};</td></tr>
<tr><td class="h">366</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>81</div></td><td class="s">&nbsp;&nbsp;my( %valid_props, @valid_props );</td></tr>
<tr><td class="h">367</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;@valid_props = qw( collect_pod inc );</td></tr>
<tr><td class="h">368</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>229</div></td><td class="s">&nbsp;&nbsp;@valid_props{@valid_props} = delete( @props{@valid_props} );</td></tr>
<tr><td class="h">369</td><td><div class="c3">70</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L369">50</a></div></td><td></td><td></td><td></td><td><div>187</div><div>0</div></td><td class="s">&nbsp;&nbsp;warn &quot;Unknown properties: @{[keys %props]}\n&quot; if scalar( %props );</td></tr>
<tr><td class="h">370</td><td colspan="7"></td></tr><tr><td class="h">371</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>466</div></td><td class="s">&nbsp;&nbsp;my %data = (</td></tr>
<tr><td class="h">372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;module&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $module,</td></tr>
<tr><td class="h">373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $filename,</td></tr>
<tr><td class="h">374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; undef,</td></tr>
<tr><td class="h">375</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;packages&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [],</td></tr>
<tr><td class="h">376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;versions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;pod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">378</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;pod_headings =&gt; [],</td></tr>
<tr><td class="h">379</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;collect_pod&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">380</td><td colspan="7"></td></tr><tr><td class="h">381</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%valid_props,</td></tr>
<tr><td class="h">382</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;);</td></tr>
<tr><td class="h">383</td><td colspan="7"></td></tr><tr><td class="h">384</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>175</div></td><td class="s">&nbsp;&nbsp;my $self = bless(\%data, $class);</td></tr>
<tr><td class="h">385</td><td colspan="7"></td></tr><tr><td class="h">386</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L386">50</a></div></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;if ( $handle ) {</td></tr>
<tr><td class="h">387</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>210</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_parse_fh($handle);</td></tr>
<tr><td class="h">388</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">390</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_parse_file();</td></tr>
<tr><td class="h">391</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">392</td><td colspan="7"></td></tr><tr><td class="h">393</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L393">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L393">33</a></div></td><td></td><td></td><td><div>242</div></td><td class="s">&nbsp;&nbsp;unless($self-&gt;{module} and length($self-&gt;{module})) {</td></tr>
<tr><td class="h">394</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>938</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($v, $d, $f) = File::Spec-&gt;splitpath($self-&gt;{filename});</td></tr>
<tr><td class="h">395</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L395">50</a></div></td><td></td><td></td><td></td><td><div>305</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if($f =~ /\.pm$/) {</td></tr>
<tr><td class="h">396</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$f =~ s/\..+$//;</td></tr>
<tr><td class="h">397</td><td><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>103</div><div>998</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @candidates = grep /$f$/, @{$self-&gt;{packages}};</td></tr>
<tr><td class="h">398</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>176</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{module} = shift(@candidates); # punt</td></tr>
<tr><td class="h">399</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">400</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">401</td><td><div class="c0">0</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L401">0</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(grep /main/, @{$self-&gt;{packages}}) {</td></tr>
<tr><td class="h">402</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{module} = &#39;main&#39;;</td></tr>
<tr><td class="h">403</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">404</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">405</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L405">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{module} = $self-&gt;{packages}[0] || &#39;&#39;;</td></tr>
<tr><td class="h">406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">407</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">408</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">409</td><td colspan="7"></td></tr><tr><td class="h">410</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L410">50</a></div></td><td></td><td></td><td></td><td><div>275</div></td><td class="s">&nbsp;&nbsp;$self-&gt;{version} = $self-&gt;{versions}{$self-&gt;{module}}</td></tr>
<tr><td class="h">411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if defined( $self-&gt;{module} );</td></tr>
<tr><td class="h">412</td><td colspan="7"></td></tr><tr><td class="h">413</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>288</div></td><td class="s">&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">415</td><td colspan="7"></td></tr><tr><td class="h">416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># class method</td></tr>
<tr><td class="h">417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _do_find_module {</td></tr>
<tr><td class="h">418</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L418">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $class&nbsp;&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">419</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L419">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $module&nbsp;&nbsp;= shift || croak &#39;find_module_by_name() requires a package name&#39;;</td></tr>
<tr><td class="h">420</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L420">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $dirs&nbsp;&nbsp;&nbsp;&nbsp;= shift || \@INC;</td></tr>
<tr><td class="h">421</td><td colspan="7"></td></tr><tr><td class="h">422</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $file = File::Spec-&gt;catfile(split( /::/, $module));</td></tr>
<tr><td class="h">423</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;foreach my $dir ( @$dirs ) {</td></tr>
<tr><td class="h">424</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $testfile = File::Spec-&gt;catfile($dir, $file);</td></tr>
<tr><td class="h">425</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L425">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L425">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ File::Spec-&gt;rel2abs( $testfile ), $dir ]</td></tr>
<tr><td class="h">426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if -e $testfile and !-d _;&nbsp;&nbsp;# For stuff like ExtUtils::xsubpp</td></tr>
<tr><td class="h">427</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L427">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return [ File::Spec-&gt;rel2abs( &quot;$testfile.pm&quot; ), $dir ]</td></tr>
<tr><td class="h">428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if -e &quot;$testfile.pm&quot;;</td></tr>
<tr><td class="h">429</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">430</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">431</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">432</td><td colspan="7"></td></tr><tr><td class="h">433</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># class method</td></tr>
<tr><td class="h">434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_module_by_name {</td></tr>
<tr><td class="h">435</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L435">0</a></div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L435">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $found = shift()-&gt;_do_find_module(@_) or return;</td></tr>
<tr><td class="h">436</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return $found-&gt;[0];</td></tr>
<tr><td class="h">437</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">438</td><td colspan="7"></td></tr><tr><td class="h">439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># class method</td></tr>
<tr><td class="h">440</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_module_dir_by_name {</td></tr>
<tr><td class="h">441</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L441">0</a></div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L441">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $found = shift()-&gt;_do_find_module(@_) or return;</td></tr>
<tr><td class="h">442</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return $found-&gt;[1];</td></tr>
<tr><td class="h">443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">444</td><td colspan="7"></td></tr><tr><td class="h">445</td><td colspan="7"></td></tr><tr><td class="h">446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># given a line of perl code, attempt to parse it if it looks like a</td></tr>
<tr><td class="h">447</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># $VERSION assignment, returning sigil, full name, &amp; package name</td></tr>
<tr><td class="h">448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _parse_version_expression {</td></tr>
<tr><td class="h">449</td><td><div class="c3">140</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L449">140</a></div></td><td></td><td><div>173</div></td><td class="s">&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">450</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>158</div></td><td class="s">&nbsp;&nbsp;my $line = shift;</td></tr>
<tr><td class="h">451</td><td colspan="7"></td></tr><tr><td class="h">452</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;my( $sig, $var, $pkg );</td></tr>
<tr><td class="h">453</td><td><div class="c3">140</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L453">100</a></div></td><td></td><td></td><td></td><td><div>890</div></td><td class="s">&nbsp;&nbsp;if ( $line =~ /$VERS_REGEXP/o ) {</td></tr>
<tr><td class="h">454</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L454">50</a></div></td><td></td><td></td><td></td><td><div>395</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;( $sig, $var, $pkg ) = $2 ? ( $1, $2, $3 ) : ( $4, $5, $6 );</td></tr>
<tr><td class="h">455</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L455">50</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $pkg ) {</td></tr>
<tr><td class="h">456</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L456">50</a></div></td><td></td><td></td><td></td><td><div>153</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pkg = ($pkg eq &#39;::&#39;) ? &#39;main&#39; : $pkg;</td></tr>
<tr><td class="h">457</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pkg =~ s/::$//;</td></tr>
<tr><td class="h">458</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">460</td><td colspan="7"></td></tr><tr><td class="h">461</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>322</div></td><td class="s">&nbsp;&nbsp;return ( $sig, $var, $pkg );</td></tr>
<tr><td class="h">462</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">463</td><td colspan="7"></td></tr><tr><td class="h">464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _parse_file {</td></tr>
<tr><td class="h">465</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L465">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">466</td><td colspan="7"></td></tr><tr><td class="h">467</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $filename = $self-&gt;{filename};</td></tr>
<tr><td class="h">468</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L468">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $fh = IO::File-&gt;new( $filename )</td></tr>
<tr><td class="h">469</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;or croak( &quot;Can&#39;t open &#39;$filename&#39;: $!&quot; );</td></tr>
<tr><td class="h">470</td><td colspan="7"></td></tr><tr><td class="h">471</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;$self-&gt;_handle_bom($fh, $filename);</td></tr>
<tr><td class="h">472</td><td colspan="7"></td></tr><tr><td class="h">473</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;$self-&gt;_parse_fh($fh);</td></tr>
<tr><td class="h">474</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">475</td><td colspan="7"></td></tr><tr><td class="h">476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Look for a UTF-8/UTF-16BE/UTF-16LE BOM at the beginning of the stream.</td></tr>
<tr><td class="h">477</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># If there&#39;s one, then skip it and set the :encoding layer appropriately.</td></tr>
<tr><td class="h">478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _handle_bom {</td></tr>
<tr><td class="h">479</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L479">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my ($self, $fh, $filename) = @_;</td></tr>
<tr><td class="h">480</td><td colspan="7"></td></tr><tr><td class="h">481</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $pos = $fh-&gt;getpos;</td></tr>
<tr><td class="h">482</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L482">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return unless defined $pos;</td></tr>
<tr><td class="h">483</td><td colspan="7"></td></tr><tr><td class="h">484</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $buf = &#39; &#39; x 2;</td></tr>
<tr><td class="h">485</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $count = $fh-&gt;read( $buf, length $buf );</td></tr>
<tr><td class="h">486</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L486">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L486">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return unless defined $count and $count &gt;= 2;</td></tr>
<tr><td class="h">487</td><td colspan="7"></td></tr><tr><td class="h">488</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;my $encoding;</td></tr>
<tr><td class="h">489</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L489">0</a></div><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L489">0</a></div><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L489">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;if ( $buf eq &quot;\x{FE}\x{FF}&quot; ) {</td></tr>
<tr><td class="h">490</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$encoding = &#39;UTF-16BE&#39;;</td></tr>
<tr><td class="h">491</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} elsif ( $buf eq &quot;\x{FF}\x{FE}&quot; ) {</td></tr>
<tr><td class="h">492</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$encoding = &#39;UTF-16LE&#39;;</td></tr>
<tr><td class="h">493</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} elsif ( $buf eq &quot;\x{EF}\x{BB}&quot; ) {</td></tr>
<tr><td class="h">494</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$buf = &#39; &#39;;</td></tr>
<tr><td class="h">495</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$count = $fh-&gt;read( $buf, length $buf );</td></tr>
<tr><td class="h">496</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L496">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L496">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( defined $count and $count &gt;= 1 and $buf eq &quot;\x{BF}&quot; ) {</td></tr>
<tr><td class="h">497</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$encoding = &#39;UTF-8&#39;;</td></tr>
<tr><td class="h">498</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">500</td><td colspan="7"></td></tr><tr><td class="h">501</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L501">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;if ( defined $encoding ) {</td></tr>
<tr><td class="h">502</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L502">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( &quot;$]&quot; &gt;= 5.008 ) {</td></tr>
<tr><td class="h">503</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $fh-&gt;binmode requires perl 5.10</td></tr>
<tr><td class="h">504</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binmode( $fh, &quot;:encoding($encoding)&quot; );</td></tr>
<tr><td class="h">505</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">507</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L507">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$fh-&gt;setpos($pos)</td></tr>
<tr><td class="h">508</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or croak( sprintf &quot;Can&#39;t reset position to the top of &#39;$filename&#39;&quot; );</td></tr>
<tr><td class="h">509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">510</td><td colspan="7"></td></tr><tr><td class="h">511</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return $encoding;</td></tr>
<tr><td class="h">512</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">513</td><td colspan="7"></td></tr><tr><td class="h">514</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _parse_fh {</td></tr>
<tr><td class="h">515</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L515">70</a></div></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;my ($self, $fh) = @_;</td></tr>
<tr><td class="h">516</td><td colspan="7"></td></tr><tr><td class="h">517</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;my( $in_pod, $seen_end, $need_vers ) = ( 0, 0, 0 );</td></tr>
<tr><td class="h">518</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>83</div></td><td class="s">&nbsp;&nbsp;my( @pkgs, %vers, %pod, @pod );</td></tr>
<tr><td class="h">519</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;my $pkg = &#39;main&#39;;</td></tr>
<tr><td class="h">520</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;my $pod_sect = &#39;&#39;;</td></tr>
<tr><td class="h">521</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;my $pod_data = &#39;&#39;;</td></tr>
<tr><td class="h">522</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;my $in_end = 0;</td></tr>
<tr><td class="h">523</td><td colspan="7"></td></tr><tr><td class="h">524</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>960</div></td><td class="s">&nbsp;&nbsp;while (defined( my $line = &lt;$fh&gt; )) {</td></tr>
<tr><td class="h">525</td><td><div class="c3">29260</div></td><td></td><td></td><td></td><td></td><td><div>27369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $line_num = $.;</td></tr>
<tr><td class="h">526</td><td colspan="7"></td></tr><tr><td class="h">527</td><td><div class="c3">29260</div></td><td></td><td></td><td></td><td></td><td><div>23191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;chomp( $line );</td></tr>
<tr><td class="h">528</td><td colspan="7"></td></tr><tr><td class="h">529</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# From toke.c : any line that begins by &quot;=X&quot;, where X is an alphabetic</td></tr>
<tr><td class="h">530</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# character, introduces a POD segment.</td></tr>
<tr><td class="h">531</td><td><div class="c3">29260</div></td><td></td><td></td><td></td><td></td><td><div>20327</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $is_cut;</td></tr>
<tr><td class="h">532</td><td><div class="c3">29260</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L532">50</a></div></td><td></td><td></td><td></td><td><div>40827</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $line =~ /^=([a-zA-Z].*)/ ) {</td></tr>
<tr><td class="h">533</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cmd = $1;</td></tr>
<tr><td class="h">534</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Then it goes back to Perl code for &quot;=cutX&quot; where X is a non-alphabetic</td></tr>
<tr><td class="h">535</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# character (which includes the newline, but here we chomped it away).</td></tr>
<tr><td class="h">536</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$is_cut = $cmd =~ /^cut(?:[^a-zA-Z]|$)/;</td></tr>
<tr><td class="h">537</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_pod = !$is_cut;</td></tr>
<tr><td class="h">538</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">539</td><td colspan="7"></td></tr><tr><td class="h">540</td><td><div class="c3">29260</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L540">50</a></div><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L540">50</a></div></td><td></td><td></td><td></td><td><div>42623</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $in_pod ) {</td></tr>
<tr><td class="h">541</td><td colspan="7"></td></tr><tr><td class="h">542</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L542">0</a></div><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L542">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $line =~ /^=head[1-4]\s+(.+)\s*$/ ) {</td></tr>
<tr><td class="h">543</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @pod, $1 );</td></tr>
<tr><td class="h">544</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L544">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L544">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $self-&gt;{collect_pod} &amp;&amp; length( $pod_data ) ) {</td></tr>
<tr><td class="h">545</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod{$pod_sect} = $pod_data;</td></tr>
<tr><td class="h">546</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod_data = &#39;&#39;;</td></tr>
<tr><td class="h">547</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">548</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod_sect = $1;</td></tr>
<tr><td class="h">549</td><td colspan="7"></td></tr><tr><td class="h">550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $self-&gt;{collect_pod} ) {</td></tr>
<tr><td class="h">551</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod_data .= &quot;$line\n&quot;;</td></tr>
<tr><td class="h">552</td><td colspan="7"></td></tr><tr><td class="h">553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">554</td><td colspan="7"></td></tr><tr><td class="h">555</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $is_cut ) {</td></tr>
<tr><td class="h">556</td><td colspan="7"></td></tr><tr><td class="h">557</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L557">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L557">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $self-&gt;{collect_pod} &amp;&amp; length( $pod_data ) ) {</td></tr>
<tr><td class="h">558</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod{$pod_sect} = $pod_data;</td></tr>
<tr><td class="h">559</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod_data = &#39;&#39;;</td></tr>
<tr><td class="h">560</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">561</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pod_sect = &#39;&#39;;</td></tr>
<tr><td class="h">562</td><td colspan="7"></td></tr><tr><td class="h">563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">564</td><td colspan="7"></td></tr><tr><td class="h">565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip after __END__</td></tr>
<tr><td class="h">566</td><td><div class="c3">29260</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L566">50</a></div></td><td></td><td></td><td></td><td><div>37298</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $in_end;</td></tr>
<tr><td class="h">567</td><td colspan="7"></td></tr><tr><td class="h">568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Skip comments in code</td></tr>
<tr><td class="h">569</td><td><div class="c3">29260</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L569">100</a></div></td><td></td><td></td><td></td><td><div>44089</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $line =~ /^\s*#/;</td></tr>
<tr><td class="h">570</td><td colspan="7"></td></tr><tr><td class="h">571</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Would be nice if we could also check $in_string or something too</td></tr>
<tr><td class="h">572</td><td><div class="c3">28000</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L572">50</a></div></td><td></td><td></td><td></td><td><div>37038</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($line eq &#39;__END__&#39;) {</td></tr>
<tr><td class="h">573</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$in_end++;</td></tr>
<tr><td class="h">574</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">576</td><td><div class="c3">28000</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L576">100</a></div></td><td></td><td></td><td></td><td><div>35800</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if $line eq &#39;__DATA__&#39;;</td></tr>
<tr><td class="h">577</td><td colspan="7"></td></tr><tr><td class="h">578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# parse $line to see if it&#39;s a $VERSION declaration</td></tr>
<tr><td class="h">579</td><td><div class="c3">27930</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L579">100</a></div></td><td></td><td></td><td></td><td><div>36168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my( $vers_sig, $vers_fullname, $vers_pkg ) =</td></tr>
<tr><td class="h">580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($line =~ /VERSION/)</td></tr>
<tr><td class="h">581</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $self-&gt;_parse_version_expression( $line )</td></tr>
<tr><td class="h">582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ();</td></tr>
<tr><td class="h">583</td><td colspan="7"></td></tr><tr><td class="h">584</td><td><div class="c3">27930</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L584">100</a></div><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L584">100</a></div><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L584">50</a></div><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L584">50</a></div><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L584">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L584">33</a></div><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L584">20</a></div><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L584">33</a></div><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L584">67</a></div></td><td></td><td></td><td><div>265874</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $line =~ /$PKG_REGEXP/o ) {</td></tr>
<tr><td class="h">585</td><td><div class="c3">280</div></td><td></td><td></td><td></td><td></td><td><div>491</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pkg = $1;</td></tr>
<tr><td class="h">586</td><td><div class="c3">280</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L586">100</a></div></td><td></td><td></td><td></td><td><div>802</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @pkgs, $pkg ) unless grep( $pkg eq $_, @pkgs );</td></tr>
<tr><td class="h">587</td><td><div class="c3">280</div></td><td><div class="c3" title="T/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L587">100</a></div></td><td></td><td></td><td></td><td><div>735</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vers{$pkg} = $2 unless exists( $vers{$pkg} );</td></tr>
<tr><td class="h">588</td><td><div class="c3">280</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L588">50</a></div></td><td></td><td></td><td></td><td><div>975</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_vers = defined $2 ? 0 : 1;</td></tr>
<tr><td class="h">589</td><td colspan="7"></td></tr><tr><td class="h">590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# VERSION defined with full package spec, i.e. $Module::VERSION</td></tr>
<tr><td class="h">591</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $vers_fullname &amp;&amp; $vers_pkg ) {</td></tr>
<tr><td class="h">592</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L592">50</a></div></td><td></td><td></td><td></td><td><div>246</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @pkgs, $vers_pkg ) unless grep( $vers_pkg eq $_, @pkgs );</td></tr>
<tr><td class="h">593</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L593">50</a></div></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_vers = 0 if $vers_pkg eq $pkg;</td></tr>
<tr><td class="h">594</td><td colspan="7"></td></tr><tr><td class="h">595</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L595">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L595">33</a></div></td><td></td><td></td><td><div>235</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ( defined $vers{$vers_pkg} &amp;&amp; length $vers{$vers_pkg} ) {</td></tr>
<tr><td class="h">596</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>202</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vers{$vers_pkg} =</td></tr>
<tr><td class="h">597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_evaluate_version_line( $vers_sig, $vers_fullname, $line );</td></tr>
<tr><td class="h">598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">599</td><td colspan="7"></td></tr><tr><td class="h">600</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# first non-comment line in undeclared package main is VERSION</td></tr>
<tr><td class="h">601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( !exists($vers{main}) &amp;&amp; $pkg eq &#39;main&#39; &amp;&amp; $vers_fullname ) {</td></tr>
<tr><td class="h">602</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_vers = 0;</td></tr>
<tr><td class="h">603</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v =</td></tr>
<tr><td class="h">604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_evaluate_version_line( $vers_sig, $vers_fullname, $line );</td></tr>
<tr><td class="h">605</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vers{$pkg} = $v;</td></tr>
<tr><td class="h">606</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @pkgs, &#39;main&#39; );</td></tr>
<tr><td class="h">607</td><td colspan="7"></td></tr><tr><td class="h">608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# first non-comment line in undeclared package defines package main</td></tr>
<tr><td class="h">609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( !exists($vers{main}) &amp;&amp; $pkg eq &#39;main&#39; &amp;&amp; $line =~ /\w+/ ) {</td></tr>
<tr><td class="h">610</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_vers = 1;</td></tr>
<tr><td class="h">611</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vers{main} = &#39;&#39;;</td></tr>
<tr><td class="h">612</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @pkgs, &#39;main&#39; );</td></tr>
<tr><td class="h">613</td><td colspan="7"></td></tr><tr><td class="h">614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# only keep if this is the first $VERSION seen</td></tr>
<tr><td class="h">615</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $vers_fullname &amp;&amp; $need_vers ) {</td></tr>
<tr><td class="h">616</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$need_vers = 0;</td></tr>
<tr><td class="h">617</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v =</td></tr>
<tr><td class="h">618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_evaluate_version_line( $vers_sig, $vers_fullname, $line );</td></tr>
<tr><td class="h">619</td><td colspan="7"></td></tr><tr><td class="h">620</td><td colspan="7"></td></tr><tr><td class="h">621</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L621">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L621">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ( defined $vers{$pkg} &amp;&amp; length $vers{$pkg} ) {</td></tr>
<tr><td class="h">622</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$vers{$pkg} = $v;</td></tr>
<tr><td class="h">623</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">624</td><td colspan="7"></td></tr><tr><td class="h">625</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">626</td><td colspan="7"></td></tr><tr><td class="h">627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">628</td><td colspan="7"></td></tr><tr><td class="h">629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">630</td><td colspan="7"></td></tr><tr><td class="h">631</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L631">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L631">33</a></div></td><td></td><td></td><td><div>543</div></td><td class="s">&nbsp;&nbsp;if ( $self-&gt;{collect_pod} &amp;&amp; length($pod_data) ) {</td></tr>
<tr><td class="h">632</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$pod{$pod_sect} = $pod_data;</td></tr>
<tr><td class="h">633</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">634</td><td colspan="7"></td></tr><tr><td class="h">635</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>140</div></td><td class="s">&nbsp;&nbsp;$self-&gt;{versions} = \%vers;</td></tr>
<tr><td class="h">636</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;$self-&gt;{packages} = \@pkgs;</td></tr>
<tr><td class="h">637</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;$self-&gt;{pod} = \%pod;</td></tr>
<tr><td class="h">638</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;$self-&gt;{pod_headings} = \@pod;</td></tr>
<tr><td class="h">639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">640</td><td colspan="7"></td></tr><tr><td class="h">641</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my $pn = 0;</td></tr>
<tr><td class="h">643</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _evaluate_version_line {</td></tr>
<tr><td class="h">644</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L644">70</a></div></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">645</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;my( $sigil, $var, $line ) = @_;</td></tr>
<tr><td class="h">646</td><td colspan="7"></td></tr><tr><td class="h">647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# Some of this code came from the ExtUtils:: hierarchy.</td></tr>
<tr><td class="h">648</td><td colspan="7"></td></tr><tr><td class="h">649</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# We compile into $vsub because &#39;use version&#39; would cause</td></tr>
<tr><td class="h">650</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# compiletime/runtime issues with local()</td></tr>
<tr><td class="h">651</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;my $vsub;</td></tr>
<tr><td class="h">652</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;$pn++; # everybody gets their own package</td></tr>
<tr><td class="h">653</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>307</div></td><td class="s">&nbsp;&nbsp;my $eval = qq{BEGIN { my \$dummy = q#&nbsp;&nbsp;Hide from _packages_inside()</td></tr>
<tr><td class="h">654</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#; package Module::Metadata::_version::p$pn;</td></tr>
<tr><td class="h">655</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;use version;</td></tr>
<tr><td class="h">656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;no strict;</td></tr>
<tr><td class="h">657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;no warnings;</td></tr>
<tr><td class="h">658</td><td colspan="7"></td></tr><tr><td class="h">659</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\$vsub = sub {</td></tr>
<tr><td class="h">660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $sigil$var;</td></tr>
<tr><td class="h">661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\$$var=undef;</td></tr>
<tr><td class="h">662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$line;</td></tr>
<tr><td class="h">663</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\$$var</td></tr>
<tr><td class="h">664</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">665</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}};</td></tr>
<tr><td class="h">666</td><td colspan="7"></td></tr><tr><td class="h">667</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L667">50</a></div></td><td></td><td></td><td></td><td><div>359</div></td><td class="s">&nbsp;&nbsp;$eval = $1 if $eval =~ m{^(.+)}s;</td></tr>
<tr><td class="h">668</td><td colspan="7"></td></tr><tr><td class="h">669</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;local $^W;</td></tr>
<tr><td class="h">670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# Try to get the $VERSION</td></tr>
<tr><td class="h">671</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L671">70</a></div><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L671">70</a></div><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L671">70</a></div><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L671">70</a></div></td><td></td><td><div>291</div><div>77</div><div>355</div><div>279</div><div>87</div><div>1669</div><div>263</div><div>82</div><div>3817</div><div>126</div><div>646</div><div>109</div><div>82</div><div>82</div><div>174</div><div>5238</div></td><td class="s">&nbsp;&nbsp;eval $eval;</td></tr>
<tr><td class="h">672</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# some modules say $VERSION = $Foo::Bar::VERSION, but Foo::Bar isn&#39;t</td></tr>
<tr><td class="h">673</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# installed, so we need to hunt in ./lib for it</td></tr>
<tr><td class="h">674</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L674">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L674">33</a></div></td><td></td><td></td><td><div>294</div></td><td class="s">&nbsp;&nbsp;if ( $@ =~ /Can&#39;t locate/ &amp;&amp; -d &#39;lib&#39; ) {</td></tr>
<tr><td class="h">675</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local @INC = (&#39;lib&#39;,@INC);</td></tr>
<tr><td class="h">676</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;eval $eval;</td></tr>
<tr><td class="h">677</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">678</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L678">50</a></div></td><td></td><td></td><td></td><td><div>163</div></td><td class="s">&nbsp;&nbsp;warn &quot;Error evaling version line &#39;$eval&#39; in $self-&gt;{filename}: $@\n&quot;</td></tr>
<tr><td class="h">679</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if $@;</td></tr>
<tr><td class="h">680</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L680">50</a></div></td><td></td><td></td><td></td><td><div>214</div></td><td class="s">&nbsp;&nbsp;(ref($vsub) eq &#39;CODE&#39;) or</td></tr>
<tr><td class="h">681</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;failed to build version sub for $self-&gt;{filename}&quot;;</td></tr>
<tr><td class="h">682</td><td><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>86</div><div>1402</div></td><td class="s">&nbsp;&nbsp;my $result = eval { $vsub-&gt;() };</td></tr>
<tr><td class="h">683</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L683">50</a></div></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;croak &quot;Could not get version from $self-&gt;{filename} by executing:\n$eval\n\nThe fatal error was: $@\n&quot;</td></tr>
<tr><td class="h">684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if $@;</td></tr>
<tr><td class="h">685</td><td colspan="7"></td></tr><tr><td class="h">686</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# Upgrade it into a version object</td></tr>
<tr><td class="h">687</td><td><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>91</div><div>194</div></td><td class="s">&nbsp;&nbsp;my $version = eval { _dwim_version($result) };</td></tr>
<tr><td class="h">688</td><td colspan="7"></td></tr><tr><td class="h">689</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L689">50</a></div></td><td></td><td></td><td></td><td><div>158</div></td><td class="s">&nbsp;&nbsp;croak &quot;Version &#39;$result&#39; from $self-&gt;{filename} does not appear to be valid:\n$eval\n\nThe fatal error was: $@\n&quot;</td></tr>
<tr><td class="h">690</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless defined $version; # &quot;0&quot; is OK!</td></tr>
<tr><td class="h">691</td><td colspan="7"></td></tr><tr><td class="h">692</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>380</div></td><td class="s">&nbsp;&nbsp;return $version;</td></tr>
<tr><td class="h">693</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">694</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">695</td><td colspan="7"></td></tr><tr><td class="h">696</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Try to DWIM when things fail the lax version test in obvious ways</td></tr>
<tr><td class="h">697</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;my @version_prep = (</td></tr>
<tr><td class="h">699</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Best case, it just works</td></tr>
<tr><td class="h">700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub { return shift },</td></tr>
<tr><td class="h">701</td><td colspan="7"></td></tr><tr><td class="h">702</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If we still don&#39;t have a version, try stripping any</td></tr>
<tr><td class="h">703</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# trailing junk that is prohibited by lax rules</td></tr>
<tr><td class="h">704</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub {</td></tr>
<tr><td class="h">705</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v = shift;</td></tr>
<tr><td class="h">706</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$v =~ s{([0-9])[a-z-].*$}{$1}i; # 1.23-alpha or 1.23b</td></tr>
<tr><td class="h">707</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $v;</td></tr>
<tr><td class="h">708</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">709</td><td colspan="7"></td></tr><tr><td class="h">710</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Activestate apparently creates custom versions like &#39;1.23_45_01&#39;, which</td></tr>
<tr><td class="h">711</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# cause version.pm to think it&#39;s an invalid alpha.&nbsp;&nbsp;So check for that</td></tr>
<tr><td class="h">712</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# and strip them</td></tr>
<tr><td class="h">713</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub {</td></tr>
<tr><td class="h">714</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v = shift;</td></tr>
<tr><td class="h">715</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $num_dots = () = $v =~ m{(\.)}g;</td></tr>
<tr><td class="h">716</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $num_unders = () = $v =~ m{(_)}g;</td></tr>
<tr><td class="h">717</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $leading_v = substr($v,0,1) eq &#39;v&#39;;</td></tr>
<tr><td class="h">718</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ! $leading_v &amp;&amp; $num_dots &lt; 2 &amp;&amp; $num_unders &gt; 1 ) {</td></tr>
<tr><td class="h">719</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$v =~ s{_}{}g;</td></tr>
<tr><td class="h">720</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$num_unders = () = $v =~ m{(_)}g;</td></tr>
<tr><td class="h">721</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">722</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $v;</td></tr>
<tr><td class="h">723</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">724</td><td colspan="7"></td></tr><tr><td class="h">725</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Worst case, try numifying it like we would have before version objects</td></tr>
<tr><td class="h">726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub {</td></tr>
<tr><td class="h">727</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $v = shift;</td></tr>
<tr><td class="h">728</td><td><div class="c3">70</div><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L728">70</a></div></td><td></td><td><div>306</div><div>76</div><div>24104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no warnings &#39;numeric&#39;;</td></tr>
<tr><td class="h">729</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 + $v;</td></tr>
<tr><td class="h">730</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">731</td><td colspan="7"></td></tr><tr><td class="h">732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;);</td></tr>
<tr><td class="h">733</td><td colspan="7"></td></tr><tr><td class="h">734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;sub _dwim_version {</td></tr>
<tr><td class="h">735</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L735">70</a></div></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($result) = shift;</td></tr>
<tr><td class="h">736</td><td colspan="7"></td></tr><tr><td class="h">737</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L737">50</a></div></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result if ref($result) eq &#39;version&#39;;</td></tr>
<tr><td class="h">738</td><td colspan="7"></td></tr><tr><td class="h">739</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($version, $error);</td></tr>
<tr><td class="h">740</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $f (@version_prep) {</td></tr>
<tr><td class="h">741</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>172</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $f-&gt;($result);</td></tr>
<tr><td class="h">742</td><td><div class="c3">70</div><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>84</div><div>485</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$version = eval { version-&gt;new($result) };</td></tr>
<tr><td class="h">743</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L743">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L743">0</a></div></td><td></td><td></td><td><div>168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$error ||= $@ if $@; # capture first failure</td></tr>
<tr><td class="h">744</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L744">50</a></div></td><td></td><td></td><td></td><td><div>181</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last if defined $version;</td></tr>
<tr><td class="h">745</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">746</td><td colspan="7"></td></tr><tr><td class="h">747</td><td><div class="c3">70</div></td><td><div class="c0" title="-/F"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L747">50</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak $error unless defined $version;</td></tr>
<tr><td class="h">748</td><td colspan="7"></td></tr><tr><td class="h">749</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $version;</td></tr>
<tr><td class="h">750</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">752</td><td colspan="7"></td></tr><tr><td class="h">753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">############################################################</td></tr>
<tr><td class="h">754</td><td colspan="7"></td></tr><tr><td class="h">755</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># accessors</td></tr>
<tr><td class="h">756</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L756">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">sub name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ $_[0]-&gt;{module}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">757</td><td colspan="7"></td></tr><tr><td class="h">758</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L758">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">sub filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ $_[0]-&gt;{filename}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">759</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L759">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div><div>0</div></td><td class="s">sub packages_inside { @{$_[0]-&gt;{packages}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">760</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L760">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div><div>0</div></td><td class="s">sub pod_inside&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ @{$_[0]-&gt;{pod_headings}}&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">761</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L761">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div><div>0</div></td><td class="s">sub contains_pod&nbsp;&nbsp;&nbsp;&nbsp;{ 0+@{$_[0]-&gt;{pod_headings}} }</td></tr>
<tr><td class="h">762</td><td colspan="7"></td></tr><tr><td class="h">763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub version {</td></tr>
<tr><td class="h">764</td><td><div class="c3">70</div></td><td></td><td></td><td><div class="c3"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L764">70</a></div></td><td><div class="c3">1</div></td><td><div>90</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">765</td><td><div class="c3">70</div></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L765">33</a></div></td><td></td><td></td><td><div>187</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mod&nbsp;&nbsp;= shift || $self-&gt;{module};</td></tr>
<tr><td class="h">766</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>74</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $vers;</td></tr>
<tr><td class="h">767</td><td><div class="c3">70</div></td><td><div class="c0" title="T/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L767">50</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L767">25</a></div></td><td></td><td></td><td><div>577</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( $mod ) &amp;&amp; length( $mod ) &amp;&amp;</td></tr>
<tr><td class="h">768</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exists( $self-&gt;{versions}{$mod} ) ) {</td></tr>
<tr><td class="h">769</td><td><div class="c3">70</div></td><td></td><td></td><td></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{versions}{$mod};</td></tr>
<tr><td class="h">770</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">771</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">774</td><td colspan="7"></td></tr><tr><td class="h">775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub pod {</td></tr>
<tr><td class="h">776</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--subroutine.html#L776">0</a></div></td><td><div class="c3">1</div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">777</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $sect = shift;</td></tr>
<tr><td class="h">778</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--branch.html#L778">0</a></div></td><td><div class="c0"><a href="-usr-local-lib-perl5-5-20-1-Module-Metadata-pm--condition.html#L778">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( $sect ) &amp;&amp; length( $sect ) &amp;&amp;</td></tr>
<tr><td class="h">779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exists( $self-&gt;{pod}{$sect} ) ) {</td></tr>
<tr><td class="h">780</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{pod}{$sect};</td></tr>
<tr><td class="h">781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">782</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">785</td><td colspan="7"></td></tr><tr><td class="h">786</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h">787</td><td colspan="7"></td></tr><tr><td class="h">788 - 1015</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

Module::Metadata - Gather package and POD information from perl module files

=head1 SYNOPSIS

&nbsp;&nbsp;use Module::Metadata;

&nbsp;&nbsp;# information about a .pm file
&nbsp;&nbsp;my $info = Module::Metadata-&gt;new_from_file( $file );
&nbsp;&nbsp;my $version = $info-&gt;version;

&nbsp;&nbsp;# CPAN META &#39;provides&#39; field for .pm files in a directory
&nbsp;&nbsp;my $provides = Module::Metadata-&gt;provides(
&nbsp;&nbsp;&nbsp;&nbsp;dir =&gt; &#39;lib&#39;, version =&gt; 2
&nbsp;&nbsp;);

=head1 DESCRIPTION

This module provides a standard way to gather metadata about a .pm file through
(mostly) static analysis and (some) code execution.&nbsp;&nbsp;When determining the
version of a module, the C&lt;$VERSION&gt; assignment is C&lt;eval&gt;ed, as is traditional
in the CPAN toolchain.

=head1 USAGE

=head2 Class methods

=over 4

=item C&lt;&lt; new_from_file($filename, collect_pod =&gt; 1) &gt;&gt;

Constructs a C&lt;Module::Metadata&gt; object given the path to a file.&nbsp;&nbsp;Returns
undef if the filename does not exist.

C&lt;collect_pod&gt; is a optional boolean argument that determines whether POD
data is collected and stored for reference.&nbsp;&nbsp;POD data is not collected by
default.&nbsp;&nbsp;POD headings are always collected.

If the file begins by an UTF-8, UTF-16BE or UTF-16LE byte-order mark, then
it is skipped before processing, and the content of the file is also decoded
appropriately starting from perl 5.8.

=item C&lt;&lt; new_from_handle($handle, $filename, collect_pod =&gt; 1) &gt;&gt;

This works just like C&lt;new_from_file&gt;, except that a handle can be provided
as the first argument.

Note that there is no validation to confirm that the handle is a handle or
something that can act like one.&nbsp;&nbsp;Passing something that isn&#39;t a handle will
cause a exception when trying to read from it.&nbsp;&nbsp;The C&lt;filename&gt; argument is
mandatory or undef will be returned.

You are responsible for setting the decoding layers on C&lt;$handle&gt; if
required.

=item C&lt;&lt; new_from_module($module, collect_pod =&gt; 1, inc =&gt; \@dirs) &gt;&gt;

Constructs a C&lt;Module::Metadata&gt; object given a module or package name.
Returns undef if the module cannot be found.

In addition to accepting the C&lt;collect_pod&gt; argument as described above,
this method accepts a C&lt;inc&gt; argument which is a reference to an array of
directories to search for the module.&nbsp;&nbsp;If none are given, the default is
@INC.

If the file that contains the module begins by an UTF-8, UTF-16BE or
UTF-16LE byte-order mark, then it is skipped before processing, and the
content of the file is also decoded appropriately starting from perl 5.8.

=item C&lt;&lt; find_module_by_name($module, \@dirs) &gt;&gt;

Returns the path to a module given the module or package name. A list
of directories can be passed in as an optional parameter, otherwise
@INC is searched.

Can be called as either an object or a class method.

=item C&lt;&lt; find_module_dir_by_name($module, \@dirs) &gt;&gt;

Returns the entry in C&lt;@dirs&gt; (or C&lt;@INC&gt; by default) that contains
the module C&lt;$module&gt;. A list of directories can be passed in as an
optional parameter, otherwise @INC is searched.

Can be called as either an object or a class method.

=item C&lt;&lt; provides( %options ) &gt;&gt;

This is a convenience wrapper around C&lt;package_versions_from_directory&gt;
to generate a CPAN META C&lt;provides&gt; data structure.&nbsp;&nbsp;It takes key/value
pairs.&nbsp;&nbsp;Valid option keys include:

=over

=item version B&lt;(required)&gt;

Specifies which version of the L&lt;CPAN::Meta::Spec&gt; should be used as
the format of the C&lt;provides&gt; output.&nbsp;&nbsp;Currently only &#39;1.4&#39; and &#39;2&#39;
are supported (and their format is identical).&nbsp;&nbsp;This may change in
the future as the definition of C&lt;provides&gt; changes.

The C&lt;version&gt; option is required.&nbsp;&nbsp;If it is omitted or if
an unsupported version is given, then C&lt;provides&gt; will throw an error.

=item dir

Directory to search recursively for F&lt;.pm&gt; files.&nbsp;&nbsp;May not be specified with
C&lt;files&gt;.

=item files

Array reference of files to examine.&nbsp;&nbsp;May not be specified with C&lt;dir&gt;.

=item prefix

String to prepend to the C&lt;file&gt; field of the resulting output. This defaults
to F&lt;lib&gt;, which is the common case for most CPAN distributions with their
F&lt;.pm&gt; files in F&lt;lib&gt;.&nbsp;&nbsp;This option ensures the META information has the
correct relative path even when the C&lt;dir&gt; or C&lt;files&gt; arguments are
absolute or have relative paths from a location other than the distribution
root.

=back

For example, given C&lt;dir&gt; of &#39;lib&#39; and C&lt;prefix&gt; of &#39;lib&#39;, the return value
is a hashref of the form:

&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Package::Name&#39; =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version =&gt; &#39;0.123&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file =&gt; &#39;lib/Package/Name.pm&#39;
&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&#39;OtherPackage::Name&#39; =&gt; ...
&nbsp;&nbsp;}

=item C&lt;&lt; package_versions_from_directory($dir, \@files?) &gt;&gt;

Scans C&lt;$dir&gt; for .pm files (unless C&lt;@files&gt; is given, in which case looks
for those files in C&lt;$dir&gt; - and reads each file for packages and versions,
returning a hashref of the form:

&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Package::Name&#39; =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version =&gt; &#39;0.123&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file =&gt; &#39;Package/Name.pm&#39;
&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&#39;OtherPackage::Name&#39; =&gt; ...
&nbsp;&nbsp;}

The C&lt;DB&gt; and C&lt;main&gt; packages are always omitted, as are any &quot;private&quot;
packages that have leading underscores in the namespace (e.g.
C&lt;Foo::_private&gt;)

Note that the file path is relative to C&lt;$dir&gt; if that is specified.
This B&lt;must not&gt; be used directly for CPAN META C&lt;provides&gt;.&nbsp;&nbsp;See
the C&lt;provides&gt; method instead.

=item C&lt;&lt; log_info (internal) &gt;&gt;

Used internally to perform logging; imported from Log::Contextual if
Log::Contextual has already been loaded, otherwise simply calls warn.

=back

=head2 Object methods

=over 4

=item C&lt;&lt; name() &gt;&gt;

Returns the name of the package represented by this module. If there
are more than one packages, it makes a best guess based on the
filename. If it&#39;s a script (i.e. not a *.pm) the package name is
&#39;main&#39;.

=item C&lt;&lt; version($package) &gt;&gt;

Returns the version as defined by the $VERSION variable for the
package as returned by the C&lt;name&gt; method if no arguments are
given. If given the name of a package it will attempt to return the
version of that package if it is specified in the file.

=item C&lt;&lt; filename() &gt;&gt;

Returns the absolute path to the file.

=item C&lt;&lt; packages_inside() &gt;&gt;

Returns a list of packages. Note: this is a raw list of packages
discovered (or assumed, in the case of C&lt;main&gt;).&nbsp;&nbsp;It is not
filtered for C&lt;DB&gt;, C&lt;main&gt; or private packages the way the
C&lt;provides&gt; method does.&nbsp;&nbsp;Invalid package names are not returned,
for example &quot;Foo:Bar&quot;.&nbsp;&nbsp;Strange but valid package names are
returned, for example &quot;Foo::Bar::&quot;, and are left up to the caller
on how to handle.

=item C&lt;&lt; pod_inside() &gt;&gt;

Returns a list of POD sections.

=item C&lt;&lt; contains_pod() &gt;&gt;

Returns true if there is any POD in the file.

=item C&lt;&lt; pod($section) &gt;&gt;

Returns the POD data in the given section.

=back

=head1 AUTHOR

Original code from Module::Build::ModuleInfo by Ken Williams
&lt;kwilliams@cpan.org&gt;, Randy W. Sims &lt;RandyS@ThePierianSpring.org&gt;

Released as Module::Metadata by Matt S Trout (mst) &lt;mst@shadowcat.co.uk&gt; with
assistance from David Golden (xdg) &lt;dagolden@cpan.org&gt;.

=head1 COPYRIGHT &amp; LICENSE

Original code Copyright (c) 2001-2011 Ken Williams.
Additional code Copyright (c) 2010-2011 Matt Trout and David Golden.
All rights reserved.

This library is free software; you can redistribute it and/or
modify it under the same terms as Perl itself.

=cut</pre></td></tr>
<tr><td class="h">1016</td><td colspan="7"></td></tr></table>
</body>
</html>
